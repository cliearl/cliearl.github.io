<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='이번 포스팅에서는 RecyclerView에 Swipe, Drag, Touch 동작을 연결하는 법에 대해 알아보도록 하겠습니다.
이번에 만들어볼 앱에서는 ViewHolder를 스와이프하면 삭제가 되고, 잡고 끌면 위아래로 ViewHolder를 이동할 수 있으며, ViewHolder를 터치하면 그 내용이 변하는 동작을 수행하도록 하겠습니다.
여기서는 제가 RecyclerView에 View Binding 적용하기 강의에서 만들었던 Recyclerview 앱을 수정하는 방식으로 구현해보겠습니다.
리팩토링 우선 View Binding을 사용하도록 설정을 추가합니다.
android { buildFeatures.viewBinding true } 메인액티비티에서 만들어주던 dataSet은 초기화시 데이터를 바로 입력하도록 하고 Recyclerview 어댑터 안쪽으로 이동시켜서 받아오는 파라미터를 삭제합니다.'><title>RecyclerView를 Swipe, Drag, Touch하기</title>

<link rel='canonical' href='https://cliearl.github.io/posts/android/recyclerview-touch/'>

<link rel="stylesheet" href="/scss/style.min.5f343aefda6021d7c99a35d0d8a06abdad13d86982967b5b28f1008e404a346d.css"><meta property='og:title' content='RecyclerView를 Swipe, Drag, Touch하기'>
<meta property='og:description' content='이번 포스팅에서는 RecyclerView에 Swipe, Drag, Touch 동작을 연결하는 법에 대해 알아보도록 하겠습니다.
이번에 만들어볼 앱에서는 ViewHolder를 스와이프하면 삭제가 되고, 잡고 끌면 위아래로 ViewHolder를 이동할 수 있으며, ViewHolder를 터치하면 그 내용이 변하는 동작을 수행하도록 하겠습니다.
여기서는 제가 RecyclerView에 View Binding 적용하기 강의에서 만들었던 Recyclerview 앱을 수정하는 방식으로 구현해보겠습니다.
리팩토링 우선 View Binding을 사용하도록 설정을 추가합니다.
android { buildFeatures.viewBinding true } 메인액티비티에서 만들어주던 dataSet은 초기화시 데이터를 바로 입력하도록 하고 Recyclerview 어댑터 안쪽으로 이동시켜서 받아오는 파라미터를 삭제합니다.'>
<meta property='og:url' content='https://cliearl.github.io/posts/android/recyclerview-touch/'>
<meta property='og:site_name' content='냉동코더의 기술블로그'>
<meta property='og:type' content='article'><meta property='article:section' content='Posts' /><meta property='article:tag' content='RecyclerView' /><meta property='article:tag' content='swipe' /><meta property='article:tag' content='drag' /><meta property='article:tag' content='touch' /><meta property='article:published_time' content='2021-04-18T22:40:04&#43;09:00'/><meta property='article:modified_time' content='2021-04-18T22:40:04&#43;09:00'/>
<meta name="twitter:title" content="RecyclerView를 Swipe, Drag, Touch하기">
<meta name="twitter:description" content="이번 포스팅에서는 RecyclerView에 Swipe, Drag, Touch 동작을 연결하는 법에 대해 알아보도록 하겠습니다.
이번에 만들어볼 앱에서는 ViewHolder를 스와이프하면 삭제가 되고, 잡고 끌면 위아래로 ViewHolder를 이동할 수 있으며, ViewHolder를 터치하면 그 내용이 변하는 동작을 수행하도록 하겠습니다.
여기서는 제가 RecyclerView에 View Binding 적용하기 강의에서 만들었던 Recyclerview 앱을 수정하는 방식으로 구현해보겠습니다.
리팩토링 우선 View Binding을 사용하도록 설정을 추가합니다.
android { buildFeatures.viewBinding true } 메인액티비티에서 만들어주던 dataSet은 초기화시 데이터를 바로 입력하도록 하고 Recyclerview 어댑터 안쪽으로 이동시켜서 받아오는 파라미터를 삭제합니다.">
    <link rel="shortcut icon" href="favicon/favicon.ico" />

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-769063-3', 'auto');
	
	ga('send', 'pageview');
}
</script>
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "dark");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/android/" >
                android
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/posts/android/recyclerview-touch/">RecyclerView를 Swipe, Drag, Touch하기</a>
    </h2>

    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Apr 18, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    4 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    
    
    <p>이번 포스팅에서는 RecyclerView에 Swipe, Drag, Touch 동작을 연결하는 법에 대해 알아보도록 하겠습니다.</p>
<p>이번에 만들어볼 앱에서는 ViewHolder를 스와이프하면 삭제가 되고, 잡고 끌면 위아래로 ViewHolder를 이동할 수 있으며, ViewHolder를 터치하면 그 내용이 변하는 동작을 수행하도록 하겠습니다.</p>
<p>여기서는 제가 <a class="link" href="https://cliearl.github.io/posts/android/viewbinding-recyclerview/"  target="_blank" rel="noopener"
    >RecyclerView에 View Binding 적용하기</a> 강의에서 만들었던 Recyclerview 앱을 수정하는 방식으로 구현해보겠습니다.</p>
<h2 id="리팩토링">리팩토링</h2>
<p>우선 View Binding을 사용하도록 설정을 추가합니다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-gradle" data-lang="gradle"><span class="n">android</span> <span class="o">{</span>
    <span class="n">buildFeatures</span><span class="o">.</span><span class="na">viewBinding</span> <span class="kc">true</span>
<span class="o">}</span>
</code></pre></div><p>메인액티비티에서 만들어주던 <code>dataSet</code>은 초기화시 데이터를 바로 입력하도록 하고 Recyclerview 어댑터 안쪽으로 이동시켜서 받아오는 파라미터를 삭제합니다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="k">class</span> <span class="nc">RecyclerViewAdapter</span><span class="p">:</span> <span class="n">RecyclerView</span><span class="p">.</span><span class="n">Adapter</span><span class="p">&lt;</span><span class="n">RecyclerViewAdapter</span><span class="p">.</span><span class="n">ViewHolder</span><span class="p">&gt;()</span> <span class="p">{</span>
    <span class="k">private</span> <span class="k">val</span> <span class="py">dataSet</span><span class="p">:</span> <span class="n">ArrayList</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;&gt;</span> <span class="p">=</span> <span class="n">arrayListOf</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;&gt;().</span><span class="n">apply</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="k">in</span> <span class="m">0.</span><span class="p">.</span><span class="m">99</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">add</span><span class="p">(</span><span class="n">listOf</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">$i</span><span class="s2"> th main&#34;</span><span class="p">,</span> <span class="s2">&#34;</span><span class="si">$i</span><span class="s2"> th sub&#34;</span><span class="p">))</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>메인액티비티의 Recyclerview 프로퍼티를 정하는 부분은 <a class="link" href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/with.html"  target="_blank" rel="noopener"
    >with</a>로 묶어줍니다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="k">class</span> <span class="nc">MainActivity</span> <span class="p">:</span> <span class="n">AppCompatActivity</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">private</span> <span class="k">val</span> <span class="py">rvAdapter</span> <span class="p">=</span> <span class="n">RecyclerViewAdapter</span><span class="p">()</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">:</span> <span class="n">Bundle</span><span class="p">?)</span> <span class="p">{</span>
        <span class="n">with</span><span class="p">(</span><span class="n">binding</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">with</span><span class="p">(</span><span class="n">recyclerView</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">layoutManager</span> <span class="p">=</span> <span class="n">LinearLayoutManager</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">LinearLayoutManager</span><span class="p">.</span><span class="n">VERTICAL</span><span class="p">,</span> <span class="k">false</span><span class="p">)</span>
                <span class="n">adapter</span> <span class="p">=</span> <span class="n">rvAdapter</span>
                <span class="n">addItemDecoration</span><span class="p">(</span><span class="n">DividerItemDecoration</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">DividerItemDecoration</span><span class="p">.</span><span class="n">VERTICAL</span><span class="p">))</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h2 id="데이터-조작함수-추가">데이터 조작함수 추가</h2>
<p>데이터를 조작하는 함수를 Recyclerview 안에 다음과 같이 추가합니다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="k">class</span> <span class="nc">RecyclerViewAdapter</span><span class="p">:</span> <span class="n">RecyclerView</span><span class="p">.</span><span class="n">Adapter</span><span class="p">&lt;</span><span class="n">RecyclerViewAdapter</span><span class="p">.</span><span class="n">ViewHolder</span><span class="p">&gt;()</span> <span class="p">{</span>

    <span class="c1">// ViewHolder 포지션을 받아 그 위치의 데이터를 삭제하고 notifyItemRemoved로 어댑터에 갱신명령을 전달
</span><span class="c1"></span>    <span class="k">fun</span> <span class="nf">removeData</span><span class="p">(</span><span class="n">position</span><span class="p">:</span> <span class="n">Int</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">dataSet</span><span class="p">.</span><span class="n">removeAt</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        <span class="n">notifyItemRemoved</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// 두 개의 ViewHolder 포지션을 받아 Collections.swap으로 첫번째 위치와 두번째 위치의 데이터를 교환
</span><span class="c1"></span>    <span class="k">fun</span> <span class="nf">swapData</span><span class="p">(</span><span class="n">fromPos</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span> <span class="n">toPos</span><span class="p">:</span> <span class="n">Int</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Collections</span><span class="p">.</span><span class="n">swap</span><span class="p">(</span><span class="n">dataSet</span><span class="p">,</span> <span class="n">fromPos</span><span class="p">,</span> <span class="n">toPos</span><span class="p">)</span>
        <span class="n">notifyItemMoved</span><span class="p">(</span><span class="n">fromPos</span><span class="p">,</span> <span class="n">toPos</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// 선택한 ViewHolder 포지션의 데이터 내용을 바꾸도록 함
</span><span class="c1"></span>    <span class="k">fun</span> <span class="nf">setData</span><span class="p">(</span><span class="n">position</span><span class="p">:</span> <span class="n">Int</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">dataSet</span><span class="p">[</span><span class="n">position</span><span class="p">]</span> <span class="p">=</span> <span class="n">listOf</span><span class="p">(</span><span class="s2">&#34;main viewholder touched!&#34;</span><span class="p">,</span> <span class="s2">&#34;sub viewholder touched!&#34;</span><span class="p">)</span>
        <span class="n">notifyItemChanged</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h2 id="스와이프와-드래그-기능-붙이기">스와이프와 드래그 기능 붙이기</h2>
<p>안드로이드에서는 Recyclerview에 입력되는 스와이프와 드래그 동작을 감지하는 <a class="link" href="https://developer.android.com/reference/kotlin/androidx/recyclerview/widget/ItemTouchHelper.SimpleCallback"  target="_blank" rel="noopener"
    >ItemTouchHelper.SimpleCallback</a> 클래스가 이미 준비되어 있으니 이걸 사용하겠습니다. 이 콜백함수는 다음과 같이 정의하면 됩니다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="k">val</span> <span class="py">itemTouchCallback</span> <span class="p">=</span> <span class="k">object</span> <span class="err">: </span><span class="nc">ItemTouchHelper</span><span class="p">.</span><span class="n">SimpleCallback</span> <span class="p">(</span>
    <span class="n">ItemTouchHelper</span><span class="p">.</span><span class="n">UP</span> <span class="n">or</span> <span class="n">ItemTouchHelper</span><span class="p">.</span><span class="n">DOWN</span><span class="p">,</span> <span class="n">ItemTouchHelper</span><span class="p">.</span><span class="n">LEFT</span>
        <span class="p">){</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">onMove</span><span class="p">(</span>
        <span class="n">recyclerView</span><span class="p">:</span> <span class="n">RecyclerView</span><span class="p">,</span>
        <span class="n">viewHolder</span><span class="p">:</span> <span class="n">RecyclerView</span><span class="p">.</span><span class="n">ViewHolder</span><span class="p">,</span>
        <span class="n">target</span><span class="p">:</span> <span class="n">RecyclerView</span><span class="p">.</span><span class="n">ViewHolder</span>
    <span class="p">):</span> <span class="n">Boolean</span> <span class="p">{</span>
        <span class="k">val</span> <span class="py">fromPos</span><span class="p">:</span> <span class="n">Int</span> <span class="p">=</span> <span class="n">viewHolder</span><span class="p">.</span><span class="n">adapterPosition</span>
        <span class="k">val</span> <span class="py">toPos</span><span class="p">:</span> <span class="n">Int</span> <span class="p">=</span> <span class="n">target</span><span class="p">.</span><span class="n">adapterPosition</span>
        <span class="n">rvAdapter</span><span class="p">.</span><span class="n">swapData</span><span class="p">(</span><span class="n">fromPos</span><span class="p">,</span> <span class="n">toPos</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">true</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="k">fun</span> <span class="nf">onSwiped</span><span class="p">(</span><span class="n">viewHolder</span><span class="p">:</span> <span class="n">RecyclerView</span><span class="p">.</span><span class="n">ViewHolder</span><span class="p">,</span> <span class="n">direction</span><span class="p">:</span> <span class="n">Int</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">rvAdapter</span><span class="p">.</span><span class="n">removeData</span><span class="p">(</span><span class="n">viewHolder</span><span class="p">.</span><span class="n">layoutPosition</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">ItemTouchHelper</span><span class="p">(</span><span class="n">itemTouchCallback</span><span class="p">).</span><span class="n">attachToRecyclerView</span><span class="p">(</span><span class="n">binding</span><span class="p">.</span><span class="n">recyclerView</span><span class="p">)</span>
</code></pre></div><p>우선 <code>ItemTouchHelper.SimpleCallback</code>의 인스턴스를 만들어 <a class="link" href="https://developer.android.com/reference/androidx/recyclerview/widget/ItemTouchHelper"  target="_blank" rel="noopener"
    >ItemTouchHelper</a>의 <a class="link" href="https://developer.android.com/reference/androidx/recyclerview/widget/ItemTouchHelper#attachToRecyclerView%28androidx.recyclerview.widget.RecyclerView%29"  target="_blank" rel="noopener"
    >attachToRecyclerView</a>로 Recyclerview와 연결시켜주면 스와이프와 드래그 동작을 인식할 수 있게 됩니다.</p>
<p>초기화할때 인식할 드래그 방향을 <a class="link" href="https://developer.android.com/reference/kotlin/androidx/recyclerview/widget/ItemTouchHelper.SimpleCallback#getdragdirs"  target="_blank" rel="noopener"
    >dragDirs</a>, 스와이프 방향을 <a class="link" href="https://developer.android.com/reference/kotlin/androidx/recyclerview/widget/ItemTouchHelper.SimpleCallback#getswipedirs"  target="_blank" rel="noopener"
    >swipeDirs</a>로 정해주는데 여기서는 드래그 방향은 위, 아래. 그리고 스와이프 방향은 왼쪽만 인식하도록 하였습니다.</p>
<p><code>onSwiped</code>에서는 스와이프가 일어날 때 데이터를 삭제하는 동작을 정의합니다. 터치한 ViewHolder 위치를 어댑터에 전달하여 <code>removeData</code>를 실행합니다.</p>
<p><code>onMove</code>에서는 드래그가 일어날 때 두 ViewHolder의 데이터를 교환하는 동작을 정의합니다. 드래그가 시작되었을 때 ViewHolder의 위치와 이동이 완료된 후의 ViewHolder의 위치를 각각 <code>fromPos</code>, <code>toPos</code>로 정의하고 <code>swapData</code>에 넘겨주어 데이터를 교환하게 합니다. 이때 스크롤 동작과 헷갈리지 않게 하기 위해서 ViewHolder를 드래그하기 위해서는 롱터치를 해야 합니다.</p>
<p>이때 <code>onSwiped</code>에서는 <a class="link" href="https://developer.android.com/reference/androidx/recyclerview/widget/RecyclerView.ViewHolder#getLayoutPosition%28%29"  target="_blank" rel="noopener"
    >layoutPosition</a>을 사용했고, <code>onMove</code>에서는 <a class="link" href="https://developer.android.com/reference/androidx/recyclerview/widget/RecyclerView.ViewHolder#getAdapterPosition%28%29"  target="_blank" rel="noopener"
    >adapterPosition</a>을 사용했습니다. 스와이프를 할 때 ViewHolder의 위치는 고정되어 있지만 드래그를 할때는 ViewHolder의 위치가 계속 변하게 됩니다. <code>adapterPosition</code>은 전체 Recyclerview 안에서 위치를 가져오는 속성이고 <code>layoutPosition</code>은 고정된 ViewHolder의 위치를 가져오는 속성입니다.</p>
<h2 id="viewholder에-드래그-가능-여부를-알리는-이미지-표시">ViewHolder에 드래그 가능 여부를 알리는 이미지 표시</h2>
<p>현재는 ViewHolder가 데이터만 표시되고 있어서 이 ViewHolder를 드래그 할수 있는지 바로 알수 있는 방법이 없습니다. 그래서 ViewHolder 오른쪽에 햄버거 마크를 넣어서 드래그 할 수 있는 ViewHolder라는 표시를 해 주도록 하겠습니다.</p>
<p>아이콘은 <code>Vector Asset</code> 메뉴에서 추가하고 <code>LinearLayout</code>과 <code>FrameLayout</code>을 섞어서 ViewHolder 모양을 수정했습니다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;LinearLayout</span>
    <span class="na">xmlns:android=</span><span class="s">&#34;http://schemas.android.com/apk/res/android&#34;</span>
    <span class="na">android:layout_width=</span><span class="s">&#34;match_parent&#34;</span>
    <span class="na">android:layout_height=</span><span class="s">&#34;wrap_content&#34;</span>
    <span class="na">android:orientation=</span><span class="s">&#34;horizontal&#34;</span>
    <span class="na">android:paddingStart=</span><span class="s">&#34;20dp&#34;</span>
    <span class="na">android:paddingEnd=</span><span class="s">&#34;20dp&#34;</span>
    <span class="na">android:gravity=</span><span class="s">&#34;center_vertical&#34;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;LinearLayout</span>
        <span class="na">android:layout_width=</span><span class="s">&#34;0dp&#34;</span>
        <span class="na">android:layout_height=</span><span class="s">&#34;wrap_content&#34;</span>
        <span class="na">android:layout_weight=</span><span class="s">&#34;9&#34;</span>
        <span class="na">android:orientation=</span><span class="s">&#34;vertical&#34;</span><span class="nt">&gt;</span>

        <span class="nt">&lt;TextView</span>
            <span class="na">android:id=</span><span class="s">&#34;@+id/tv_main&#34;</span>
            <span class="na">android:layout_width=</span><span class="s">&#34;match_parent&#34;</span>
            <span class="na">android:layout_height=</span><span class="s">&#34;wrap_content&#34;</span>
            <span class="na">android:text=</span><span class="s">&#34;Main TextView&#34;</span>
            <span class="na">android:textSize=</span><span class="s">&#34;24sp&#34;</span>
            <span class="na">android:padding=</span><span class="s">&#34;5dp&#34;</span> <span class="nt">/&gt;</span>

        <span class="nt">&lt;TextView</span>
            <span class="na">android:id=</span><span class="s">&#34;@+id/tv_sub&#34;</span>
            <span class="na">android:layout_width=</span><span class="s">&#34;match_parent&#34;</span>
            <span class="na">android:layout_height=</span><span class="s">&#34;wrap_content&#34;</span>
            <span class="na">android:text=</span><span class="s">&#34;Sub TextView&#34;</span>
            <span class="na">android:textSize=</span><span class="s">&#34;18sp&#34;</span>
            <span class="na">android:padding=</span><span class="s">&#34;5dp&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/LinearLayout&gt;</span>

    <span class="nt">&lt;FrameLayout</span>
        <span class="na">android:layout_width=</span><span class="s">&#34;wrap_content&#34;</span>
        <span class="na">android:layout_height=</span><span class="s">&#34;wrap_content&#34;</span>
        <span class="na">android:layout_weight=</span><span class="s">&#34;1&#34;</span><span class="nt">&gt;</span>

        <span class="nt">&lt;ImageView</span>
            <span class="na">android:layout_width=</span><span class="s">&#34;30dp&#34;</span>
            <span class="na">android:layout_height=</span><span class="s">&#34;30dp&#34;</span>
            <span class="na">android:layout_gravity=</span><span class="s">&#34;center&#34;</span>
            <span class="na">android:src=</span><span class="s">&#34;@drawable/ic_baseline_reorder_24&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/FrameLayout&gt;</span>

<span class="nt">&lt;/LinearLayout&gt;</span>
</code></pre></div><h2 id="스와이프시-백그라운드-설정하기">스와이프시 백그라운드 설정하기</h2>
<p>다음으로 스와이프를 할때 미끄러져 나간 ViewHolder 아래에 <a class="link" href="https://developer.android.com/reference/android/graphics/Canvas"  target="_blank" rel="noopener"
    >Canvas</a> 클래스를 이용해 작성한 빨간색 비트맵 이미지와 휴지통 아이콘을 표시되도록 하겠습니다. 이것을 위해서는 <code>ItemTouchHelper.SimpleCallback</code>의 <code>onChildDraw</code>를 사용합니다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="k">override</span> <span class="k">fun</span> <span class="nf">onChildDraw</span><span class="p">(</span>
    <span class="n">c</span><span class="p">:</span> <span class="n">Canvas</span><span class="p">,</span>
    <span class="n">recyclerView</span><span class="p">:</span> <span class="n">RecyclerView</span><span class="p">,</span>
    <span class="n">viewHolder</span><span class="p">:</span> <span class="n">RecyclerView</span><span class="p">.</span><span class="n">ViewHolder</span><span class="p">,</span>
    <span class="n">dX</span><span class="p">:</span> <span class="n">Float</span><span class="p">,</span>
    <span class="n">dY</span><span class="p">:</span> <span class="n">Float</span><span class="p">,</span>
    <span class="n">actionState</span><span class="p">:</span> <span class="n">Int</span><span class="p">,</span>
    <span class="n">isCurrentlyActive</span><span class="p">:</span> <span class="n">Boolean</span>
<span class="p">)</span> <span class="p">{</span>
    <span class="k">val</span> <span class="py">icon</span><span class="p">:</span> <span class="n">Bitmap</span>
    <span class="c1">// actionState가 SWIPE 동작일 때 배경을 빨간색으로 칠하는 작업을 수행하도록 함
</span><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="n">actionState</span> <span class="o">==</span> <span class="n">ItemTouchHelper</span><span class="p">.</span><span class="n">ACTION_STATE_SWIPE</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">val</span> <span class="py">itemView</span> <span class="p">=</span> <span class="n">viewHolder</span><span class="p">.</span><span class="n">itemView</span>
        <span class="k">val</span> <span class="py">height</span> <span class="p">=</span> <span class="p">(</span><span class="n">itemView</span><span class="p">.</span><span class="n">bottom</span> <span class="p">-</span> <span class="n">itemView</span><span class="p">.</span><span class="n">top</span><span class="p">).</span><span class="n">toFloat</span><span class="p">()</span>
        <span class="k">val</span> <span class="py">width</span> <span class="p">=</span> <span class="n">height</span> <span class="p">/</span> <span class="m">4</span>
        <span class="k">val</span> <span class="py">paint</span> <span class="p">=</span> <span class="n">Paint</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dX</span> <span class="p">&lt;</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// 왼쪽으로 스와이프하는지 확인
</span><span class="c1"></span>            <span class="c1">// ViewHolder의 백그라운드에 깔아줄 사각형의 크기와 색상을 지정
</span><span class="c1"></span>            <span class="n">paint</span><span class="p">.</span><span class="n">color</span> <span class="p">=</span> <span class="n">Color</span><span class="p">.</span><span class="n">parseColor</span><span class="p">(</span><span class="s2">&#34;#ff0000&#34;</span><span class="p">)</span>
            <span class="k">val</span> <span class="py">background</span> <span class="p">=</span> <span class="n">RectF</span><span class="p">(</span><span class="n">itemView</span><span class="p">.</span><span class="n">right</span><span class="p">.</span><span class="n">toFloat</span><span class="p">()</span> <span class="p">+</span> <span class="n">dX</span><span class="p">,</span> <span class="n">itemView</span><span class="p">.</span><span class="n">top</span><span class="p">.</span><span class="n">toFloat</span><span class="p">(),</span> <span class="n">itemView</span><span class="p">.</span><span class="n">right</span><span class="p">.</span><span class="n">toFloat</span><span class="p">(),</span> <span class="n">itemView</span><span class="p">.</span><span class="n">bottom</span><span class="p">.</span><span class="n">toFloat</span><span class="p">())</span>
            <span class="n">c</span><span class="p">.</span><span class="n">drawRect</span><span class="p">(</span><span class="n">background</span><span class="p">,</span> <span class="n">paint</span><span class="p">)</span>

            <span class="c1">// 휴지통 아이콘과 표시될 위치를 지정하고 비트맵을 그려줌
</span><span class="c1"></span>            <span class="c1">// 비트맵 이미지는 Image Asset 기능으로 추가하고 drawable 폴더에 위치하도록 함
</span><span class="c1"></span>            <span class="n">icon</span> <span class="p">=</span> <span class="n">BitmapFactory</span><span class="p">.</span><span class="n">decodeResource</span><span class="p">(</span><span class="n">resources</span><span class="p">,</span> <span class="n">R</span><span class="p">.</span><span class="n">drawable</span><span class="p">.</span><span class="n">ic_menu_delete</span><span class="p">)</span>
            <span class="k">val</span> <span class="py">iconDst</span> <span class="p">=</span> <span class="n">RectF</span><span class="p">(</span><span class="n">itemView</span><span class="p">.</span><span class="n">right</span><span class="p">.</span><span class="n">toFloat</span><span class="p">()</span> <span class="p">-</span> <span class="m">3</span>  <span class="p">-</span> <span class="n">width</span><span class="p">,</span> <span class="n">itemView</span><span class="p">.</span><span class="n">top</span><span class="p">.</span><span class="n">toFloat</span><span class="p">()</span> <span class="p">+</span> <span class="n">width</span><span class="p">,</span> <span class="n">itemView</span><span class="p">.</span><span class="n">right</span><span class="p">.</span><span class="n">toFloat</span><span class="p">()</span> <span class="p">-</span> <span class="n">width</span><span class="p">,</span> <span class="n">itemView</span><span class="p">.</span><span class="n">bottom</span><span class="p">.</span><span class="n">toFloat</span><span class="p">()</span> <span class="p">-</span> <span class="n">width</span><span class="p">)</span>
            <span class="n">c</span><span class="p">.</span><span class="n">drawBitmap</span><span class="p">(</span><span class="n">icon</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="n">iconDst</span><span class="p">,</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">super</span><span class="p">.</span><span class="n">onChildDraw</span><span class="p">(</span>
        <span class="n">c</span><span class="p">,</span>
        <span class="n">recyclerView</span><span class="p">,</span>
        <span class="n">viewHolder</span><span class="p">,</span>
        <span class="n">dX</span><span class="p">,</span>
        <span class="n">dY</span><span class="p">,</span>
        <span class="n">actionState</span><span class="p">,</span>
        <span class="n">isCurrentlyActive</span>
    <span class="p">)</span>
<span class="p">}</span>
</code></pre></div><h2 id="터치-조작-정의하기">터치 조작 정의하기</h2>
<p>Recyclerview 어댑터 안에 정의한 ViewHolder 클래스에 클릭 리스너를 붙여주면 ViewHolder의 터치를 인식할 수 있습니다. 그럴려면 ViewHolder가 사용하는 <code>list_item.xml</code>에서 레이아웃에 id를 부여해줘야 합니다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;LinearLayout</span>
    <span class="na">android:id=</span><span class="s">&#34;@+id/vhLayout&#34;</span> <span class="nt">&gt;</span>
<span class="nt">&lt;/LinearLayout&gt;</span>
</code></pre></div><p>그리고 클릭 리스너를 붙여서 <a class="link" href="https://developer.android.com/reference/com/google/android/material/snackbar/Snackbar"  target="_blank" rel="noopener"
    >Snackbar</a>로 터치한 위치를 보여주고 <code>setData</code> 함수가 실행되도록 합니다. 이때 setData는 Recyclerview 안의 함수이므로 ViewHolder 클래스에서 접근을 할 수가 없습니다. 그래서 ViewHolder를 <code>inner classs</code>로 변경하여줍니다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-kotlin" data-lang="kotlin"><span class="k">class</span> <span class="nc">RecyclerViewAdapter</span><span class="p">:</span> <span class="n">RecyclerView</span><span class="p">.</span><span class="n">Adapter</span><span class="p">&lt;</span><span class="n">RecyclerViewAdapter</span><span class="p">.</span><span class="n">ViewHolder</span><span class="p">&gt;()</span> <span class="p">{</span>

    <span class="k">inner</span> <span class="k">class</span> <span class="nc">ViewHolder</span><span class="p">(</span><span class="k">private</span> <span class="k">val</span> <span class="py">binding</span><span class="p">:</span> <span class="n">ListItemBinding</span><span class="p">)</span> <span class="p">:</span> <span class="n">RecyclerView</span><span class="p">.</span><span class="n">ViewHolder</span><span class="p">(</span><span class="n">binding</span><span class="p">.</span><span class="n">root</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">fun</span> <span class="nf">bind</span><span class="p">(</span><span class="k">data</span><span class="p">:</span><span class="n">List</span><span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;)</span> <span class="p">{</span>
            <span class="n">binding</span><span class="p">.</span><span class="n">tvMain</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="k">data</span><span class="p">[</span><span class="m">0</span><span class="p">]</span>
            <span class="n">binding</span><span class="p">.</span><span class="n">tvSub</span><span class="p">.</span><span class="n">text</span> <span class="p">=</span> <span class="k">data</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>

            <span class="n">binding</span><span class="p">.</span><span class="n">vhLayout</span><span class="p">.</span><span class="n">setOnClickListener</span> <span class="p">{</span>
                <span class="n">Snackbar</span><span class="p">.</span><span class="n">make</span><span class="p">(</span><span class="k">it</span><span class="p">,</span> <span class="s2">&#34;Item </span><span class="si">$layoutPosition</span><span class="s2"> touched!&#34;</span><span class="p">,</span> <span class="n">Snackbar</span><span class="p">.</span><span class="n">LENGTH_SHORT</span><span class="p">).</span><span class="n">show</span><span class="p">()</span>
                <span class="n">setData</span><span class="p">(</span><span class="n">layoutPosition</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h2 id="viewholder-터치시-애니메이션-추가">ViewHolder 터치시 애니메이션 추가</h2>
<p>현재는 ViewHolder를 터치했을 때 내용이 바뀌도록 하긴 했지만 정확히 어떤 ViewHolder를 터치한건지에 대한 표시가 나타나지 않습니다. 하지만 xml에 <a class="link" href="https://developer.android.com/training/material/animations#Touch"  target="_blank" rel="noopener"
    >selectableItemBackground</a> 속성을 정의하면 터치한 ViewHolder를 주목시키는 효과를 추가할 수 있습니다.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;LinearLayout</span>
    <span class="na">android:background=</span><span class="s">&#34;?attr/selectableItemBackground&#34;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/LinearLayout&gt;</span>
</code></pre></div><p>이렇게 해서 Recyclerview에 스와이프, 드래그, 터치 동작에 대한 응답을 설정하는 법에 대해 알아보았습니다.</p>
<div class="video-wrapper">
    <iframe loading="lazy" 
            src="https://www.youtube.com/embed/IaIuKbEyGnY" 
            allowfullscreen 
            title="YouTube Video"
    >
    </iframe>
</div>


</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/recyclerview/">recyclerview</a>
        
            <a href="/tags/swipe/">swipe</a>
        
            <a href="/tags/drag/">drag</a>
        
            <a href="/tags/touch/">touch</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY 4.0</span>
    </section>
    </footer>


    
</article>

    
        <div class="article-list--compact links">
    
        <article>
            <a href="https://github.com/cliearl/android-tutorial/tree/master/RecyclerViewTouches" target="_blank" rel="noopener">
                <div class="article-details">
                    <h2 class="article-title">GitHub/cliearl</h2>
                    <footer class="article-time">
                        
                            Find and download source code of the article from this link.
                        
                    </footer>
                </div>
        
                
                    <div class="article-image">
                        <img src="/images/common/GitHub-Mark-Light-120px-plus.png" loading="lazy">
                    </div>
                
            </a>
        </article>
    
</div>
    

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="">
    <a href="/posts/android/download-json-data-using-retrofit/">
        
        

        <div class="article-details">
            <h2 class="article-title">Retrofit으로 다운받은 Json 데이터를 RecyclerView에 표시하기</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/posts/android/recyclerview-listadapter/">
        
        

        <div class="article-details">
            <h2 class="article-title">DiffUtil과 ListAdapter 이해하고 RecyclerView에 적용하기</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/posts/android/recyclerview-implement/">
        
        

        <div class="article-details">
            <h2 class="article-title">앱에서 RecyclerView 사용하기</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/posts/android/viewbinding-recyclerview/">
        
        

        <div class="article-details">
            <h2 class="article-title">RecyclerView에 View Binding 적용하기</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/posts/android/viewpager-swipe/">
        
        

        <div class="article-details">
            <h2 class="article-title">ViewPager를 써서 좌우로 스와이프되는 화면 만들기</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    <script src="https://utteranc.es/client.js" 
        repo="cliearl/cliearl.github.io"
        issue-term="cliearl"
        
        crossorigin="anonymous"
        async
        >
</script>

<style>
    .utterances {
        max-width: unset;
    }
</style>

<script>
    function setUtterancesTheme(theme) {
        let utterances = document.querySelector('.utterances iframe');
        if (utterances) {
            utterances.contentWindow.postMessage(
                {
                    type: 'set-theme',
                    theme: `github-${theme}`
                },
                'https://utteranc.es'
            );
        }
    }

    addEventListener('message', event => {
        if (event.origin !== 'https://utteranc.es') return;
        setUtterancesTheme(document.documentElement.dataset.scheme)
    });

    window.addEventListener('onColorSchemeChange', (e) => {
        setUtterancesTheme(e.detail)
    })
</script>


    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2019 - 
        
        2022 냉동코더의 기술블로그
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.7.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ol>
    <li><a href="#리팩토링">리팩토링</a></li>
    <li><a href="#데이터-조작함수-추가">데이터 조작함수 추가</a></li>
    <li><a href="#스와이프와-드래그-기능-붙이기">스와이프와 드래그 기능 붙이기</a></li>
    <li><a href="#viewholder에-드래그-가능-여부를-알리는-이미지-표시">ViewHolder에 드래그 가능 여부를 알리는 이미지 표시</a></li>
    <li><a href="#스와이프시-백그라운드-설정하기">스와이프시 백그라운드 설정하기</a></li>
    <li><a href="#터치-조작-정의하기">터치 조작 정의하기</a></li>
    <li><a href="#viewholder-터치시-애니메이션-추가">ViewHolder 터치시 애니메이션 추가</a></li>
  </ol>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
